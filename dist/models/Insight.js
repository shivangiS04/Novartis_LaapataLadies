"use strict";
/**
 * Insight Model
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.InsightModel = void 0;
class InsightModel {
    constructor(data) {
        this.insightId = data.insightId || '';
        this.type = data.type || 'data_quality';
        this.title = data.title || '';
        this.description = data.description || '';
        this.supportingData = data.supportingData || {};
        this.confidence = data.confidence ?? 0.5;
        this.impact = data.impact || 'medium';
        this.urgency = data.urgency || 'medium';
        this.recommendedActions = data.recommendedActions || [];
        this.generatedDate = data.generatedDate || new Date();
        this.generatedBy = data.generatedBy || '';
    }
    validate() {
        const errors = [];
        const warnings = [];
        if (!this.insightId || this.insightId.trim() === '') {
            errors.push({
                field: 'insightId',
                message: 'Insight ID is required',
                code: 'REQUIRED_FIELD',
            });
        }
        const validTypes = ['data_quality', 'operational', 'clinical', 'predictive'];
        if (!validTypes.includes(this.type)) {
            errors.push({
                field: 'type',
                message: `Type must be one of: ${validTypes.join(', ')}`,
                code: 'INVALID_VALUE',
            });
        }
        if (!this.title || this.title.trim() === '') {
            errors.push({
                field: 'title',
                message: 'Insight title is required',
                code: 'REQUIRED_FIELD',
            });
        }
        if (this.confidence < 0 || this.confidence > 1) {
            errors.push({
                field: 'confidence',
                message: 'Confidence must be between 0 and 1',
                code: 'INVALID_VALUE',
            });
        }
        const validSeverities = ['critical', 'high', 'medium', 'low'];
        if (!validSeverities.includes(this.impact)) {
            errors.push({
                field: 'impact',
                message: `Impact must be one of: ${validSeverities.join(', ')}`,
                code: 'INVALID_VALUE',
            });
        }
        if (!validSeverities.includes(this.urgency)) {
            errors.push({
                field: 'urgency',
                message: `Urgency must be one of: ${validSeverities.join(', ')}`,
                code: 'INVALID_VALUE',
            });
        }
        if (!this.generatedBy || this.generatedBy.trim() === '') {
            warnings.push({
                field: 'generatedBy',
                message: 'Generated by should be specified',
                code: 'RECOMMENDED_FIELD',
            });
        }
        if (this.recommendedActions.length === 0) {
            warnings.push({
                field: 'recommendedActions',
                message: 'At least one recommended action should be provided',
                code: 'RECOMMENDED_FIELD',
            });
        }
        return {
            isValid: errors.length === 0,
            errors,
            warnings,
        };
    }
    addAction(action) {
        this.recommendedActions.push(action);
    }
    getPriorityScore() {
        const severityScores = {
            critical: 4,
            high: 3,
            medium: 2,
            low: 1,
        };
        const impactScore = severityScores[this.impact];
        const urgencyScore = severityScores[this.urgency];
        const confidenceScore = this.confidence * 10;
        return (impactScore + urgencyScore) * confidenceScore;
    }
    toJSON() {
        return {
            insightId: this.insightId,
            type: this.type,
            title: this.title,
            description: this.description,
            supportingData: this.supportingData,
            confidence: this.confidence,
            impact: this.impact,
            urgency: this.urgency,
            recommendedActions: this.recommendedActions,
            generatedDate: this.generatedDate,
            generatedBy: this.generatedBy,
        };
    }
}
exports.InsightModel = InsightModel;
//# sourceMappingURL=Insight.js.map